<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.8.18"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>MoreModbus: wolkabout::ModbusReader Class Reference</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
		<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">MoreModbus
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classwolkabout_1_1ModbusReader.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classwolkabout_1_1ModbusReader-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">wolkabout::ModbusReader Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Main functional class, that accepts all devices and reads them periodcally.  
 <a href="classwolkabout_1_1ModbusReader.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ModbusReader_8h_source.html">ModbusReader.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for wolkabout::ModbusReader:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classwolkabout_1_1ModbusReader.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a07c147aa0b0013bbc964524d4c52b55c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwolkabout_1_1ModbusReader.html#a07c147aa0b0013bbc964524d4c52b55c">ModbusReader</a> (<a class="el" href="classwolkabout_1_1ModbusClient.html">ModbusClient</a> &amp;modbusClient, const std::chrono::milliseconds &amp;readPeriod)</td></tr>
<tr class="memdesc:a07c147aa0b0013bbc964524d4c52b55c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main constructor for the reader, that prepares all the necessary data for reading.  <a href="classwolkabout_1_1ModbusReader.html#a07c147aa0b0013bbc964524d4c52b55c">More...</a><br /></td></tr>
<tr class="separator:a07c147aa0b0013bbc964524d4c52b55c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad6b6e5ef35ad8c51e21cbf821450824"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwolkabout_1_1ModbusReader.html#aad6b6e5ef35ad8c51e21cbf821450824">addDevice</a> (const std::shared_ptr&lt; <a class="el" href="classwolkabout_1_1ModbusDevice.html">ModbusDevice</a> &gt; &amp;device)</td></tr>
<tr class="memdesc:aad6b6e5ef35ad8c51e21cbf821450824"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method that adds a single device for the reader to read.  <a href="classwolkabout_1_1ModbusReader.html#aad6b6e5ef35ad8c51e21cbf821450824">More...</a><br /></td></tr>
<tr class="separator:aad6b6e5ef35ad8c51e21cbf821450824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb8cefa4b66b395be18fd4b44cab218e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwolkabout_1_1ModbusReader.html#afb8cefa4b66b395be18fd4b44cab218e">addDevices</a> (const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classwolkabout_1_1ModbusDevice.html">ModbusDevice</a> &gt;&gt; &amp;devices)</td></tr>
<tr class="memdesc:afb8cefa4b66b395be18fd4b44cab218e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Methods that adds multiple devices for the reader to read.  <a href="classwolkabout_1_1ModbusReader.html#afb8cefa4b66b395be18fd4b44cab218e">More...</a><br /></td></tr>
<tr class="separator:afb8cefa4b66b395be18fd4b44cab218e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3a93878ed568ee9cf558f759981d3b8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwolkabout_1_1ModbusReader.html#af3a93878ed568ee9cf558f759981d3b8">writeMapping</a> (<a class="el" href="classwolkabout_1_1RegisterMapping.html">RegisterMapping</a> &amp;mapping, const std::vector&lt; uint16_t &gt; &amp;values)</td></tr>
<tr class="memdesc:af3a93878ed568ee9cf558f759981d3b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force the reader to write to a mapping (uint16_t values)  <a href="classwolkabout_1_1ModbusReader.html#af3a93878ed568ee9cf558f759981d3b8">More...</a><br /></td></tr>
<tr class="separator:af3a93878ed568ee9cf558f759981d3b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a70b60819e0da6150bb06d1b11a8128"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwolkabout_1_1ModbusReader.html#a8a70b60819e0da6150bb06d1b11a8128">writeMapping</a> (<a class="el" href="classwolkabout_1_1RegisterMapping.html">RegisterMapping</a> &amp;mapping, bool value)</td></tr>
<tr class="memdesc:a8a70b60819e0da6150bb06d1b11a8128"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force the reader to write to a mapping (bool value)  <a href="classwolkabout_1_1ModbusReader.html#a8a70b60819e0da6150bb06d1b11a8128">More...</a><br /></td></tr>
<tr class="separator:a8a70b60819e0da6150bb06d1b11a8128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a370a24ba2a86c048bfd25a4ed28aee17"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwolkabout_1_1ModbusReader.html#a370a24ba2a86c048bfd25a4ed28aee17">writeBitMapping</a> (<a class="el" href="classwolkabout_1_1RegisterMapping.html">RegisterMapping</a> &amp;mapping, bool value)</td></tr>
<tr class="memdesc:a370a24ba2a86c048bfd25a4ed28aee17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force the reader to write to a mapping that interacts with a bit from an 16bit register.  <a href="classwolkabout_1_1ModbusReader.html#a370a24ba2a86c048bfd25a4ed28aee17">More...</a><br /></td></tr>
<tr class="separator:a370a24ba2a86c048bfd25a4ed28aee17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ef972d0ec201ca0711c14749e31ac5e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwolkabout_1_1ModbusReader.html#a3ef972d0ec201ca0711c14749e31ac5e">isRunning</a> () const</td></tr>
<tr class="memdesc:a3ef972d0ec201ca0711c14749e31ac5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates whether or not the threads that read devices are running.  <a href="classwolkabout_1_1ModbusReader.html#a3ef972d0ec201ca0711c14749e31ac5e">More...</a><br /></td></tr>
<tr class="separator:a3ef972d0ec201ca0711c14749e31ac5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef6e4f9fd2e997ae1b864149b69008f"><td class="memItemLeft" align="right" valign="top"><a id="a6ef6e4f9fd2e997ae1b864149b69008f"></a>
const std::map&lt; int8_t, std::shared_ptr&lt; <a class="el" href="classwolkabout_1_1ModbusDevice.html">ModbusDevice</a> &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>getDevices</b> () const</td></tr>
<tr class="separator:a6ef6e4f9fd2e997ae1b864149b69008f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cd6f73fa7b96824b21f8d1e59e4e419"><td class="memItemLeft" align="right" valign="top"><a id="a5cd6f73fa7b96824b21f8d1e59e4e419"></a>
const std::map&lt; int8_t, bool &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>getDeviceStatuses</b> () const</td></tr>
<tr class="separator:a5cd6f73fa7b96824b21f8d1e59e4e419"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfed743ba2a0ec0dfc41a7419ff2aca6"><td class="memItemLeft" align="right" valign="top"><a id="adfed743ba2a0ec0dfc41a7419ff2aca6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwolkabout_1_1ModbusReader.html#adfed743ba2a0ec0dfc41a7419ff2aca6">start</a> ()</td></tr>
<tr class="memdesc:adfed743ba2a0ec0dfc41a7419ff2aca6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the modbus connection, will also reconnect if it isn't working, or it disconnected in the meanwhile. If the connection is up, it will read the devices. <br /></td></tr>
<tr class="separator:adfed743ba2a0ec0dfc41a7419ff2aca6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ca028084e31722bd92e02352a0438b3"><td class="memItemLeft" align="right" valign="top"><a id="a4ca028084e31722bd92e02352a0438b3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwolkabout_1_1ModbusReader.html#a4ca028084e31722bd92e02352a0438b3">stop</a> ()</td></tr>
<tr class="memdesc:a4ca028084e31722bd92e02352a0438b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Halts the modbus connection and stops all device reading threads. <br /></td></tr>
<tr class="separator:a4ca028084e31722bd92e02352a0438b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Main functional class, that accepts all devices and reads them periodcally. </p>
<p>Function of the class is to periodically trigger the reading of all devices, of course, each and every on their separate threads. Where the connection gets split between them all, and data parsing for mappings is execute on their own thread. And also, the on value change for mappings event is invoked. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a07c147aa0b0013bbc964524d4c52b55c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07c147aa0b0013bbc964524d4c52b55c">&#9670;&nbsp;</a></span>ModbusReader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">wolkabout::ModbusReader::ModbusReader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classwolkabout_1_1ModbusClient.html">ModbusClient</a> &amp;&#160;</td>
          <td class="paramname"><em>modbusClient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::chrono::milliseconds &amp;&#160;</td>
          <td class="paramname"><em>readPeriod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main constructor for the reader, that prepares all the necessary data for reading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">modbusClient</td><td>one of implementations of the abstract class </td></tr>
    <tr><td class="paramname">readPeriod</td><td>time period for cycling reads </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aad6b6e5ef35ad8c51e21cbf821450824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad6b6e5ef35ad8c51e21cbf821450824">&#9670;&nbsp;</a></span>addDevice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wolkabout::ModbusReader::addDevice </td>
          <td>(</td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="classwolkabout_1_1ModbusDevice.html">ModbusDevice</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method that adds a single device for the reader to read. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device</td><td>shared pointer to the device </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afb8cefa4b66b395be18fd4b44cab218e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb8cefa4b66b395be18fd4b44cab218e">&#9670;&nbsp;</a></span>addDevices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wolkabout::ModbusReader::addDevices </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::shared_ptr&lt; <a class="el" href="classwolkabout_1_1ModbusDevice.html">ModbusDevice</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>devices</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Methods that adds multiple devices for the reader to read. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">devices</td><td>vector containing all shared pointers for devices </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3ef972d0ec201ca0711c14749e31ac5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ef972d0ec201ca0711c14749e31ac5e">&#9670;&nbsp;</a></span>isRunning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool wolkabout::ModbusReader::isRunning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicates whether or not the threads that read devices are running. </p>
<dl class="section return"><dt>Returns</dt><dd>thread running status </dd></dl>

</div>
</div>
<a id="a370a24ba2a86c048bfd25a4ed28aee17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a370a24ba2a86c048bfd25a4ed28aee17">&#9670;&nbsp;</a></span>writeBitMapping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool wolkabout::ModbusReader::writeBitMapping </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classwolkabout_1_1RegisterMapping.html">RegisterMapping</a> &amp;&#160;</td>
          <td class="paramname"><em>mapping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Force the reader to write to a mapping that interacts with a bit from an 16bit register. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mapping</td><td>reference to bit mapping from one of the device that the reader was passed in constructor </td></tr>
    <tr><td class="paramname">value</td><td>single boolean </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether or not the operation was successful </dd></dl>

</div>
</div>
<a id="a8a70b60819e0da6150bb06d1b11a8128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a70b60819e0da6150bb06d1b11a8128">&#9670;&nbsp;</a></span>writeMapping() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool wolkabout::ModbusReader::writeMapping </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classwolkabout_1_1RegisterMapping.html">RegisterMapping</a> &amp;&#160;</td>
          <td class="paramname"><em>mapping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Force the reader to write to a mapping (bool value) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mapping</td><td>reference to mapping from one of device that the reader was passed in constructor </td></tr>
    <tr><td class="paramname">value</td><td>single boolean </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether or not the operation was successful </dd></dl>

</div>
</div>
<a id="af3a93878ed568ee9cf558f759981d3b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3a93878ed568ee9cf558f759981d3b8">&#9670;&nbsp;</a></span>writeMapping() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool wolkabout::ModbusReader::writeMapping </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classwolkabout_1_1RegisterMapping.html">RegisterMapping</a> &amp;&#160;</td>
          <td class="paramname"><em>mapping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint16_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Force the reader to write to a mapping (uint16_t values) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mapping</td><td>reference to mapping from one of devices that the reader was passed in constructor </td></tr>
    <tr><td class="paramname">values</td><td>array of uint16_t's, needs to contain exact amount of values as the mapping has in register count. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether or not the operation was successful </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="ModbusReader_8h_source.html">ModbusReader.h</a></li>
<li>src/ModbusReader.cpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<li class="navelem"><b>wolkabout</b></li><li class="navelem"><a class="el" href="classwolkabout_1_1ModbusReader.html">ModbusReader</a></li>
				<li class="footer">
					Generated on Thu Apr 9 2020 11:47:57 for MoreModbus by <a href="http://www.doxygen.org/index.html">
					<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18.
					Dark theme by <a href="http://majerle.eu" target="_new">Tilen Majerle</a>. All rights reserved.
				</li>
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>